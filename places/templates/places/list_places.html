{% extends "webpage/base.html" %}
{% block Titel %}Edit Places{% endblock %}

{% block scriptHeader %}<!--leafletjs -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.js"></script>
        <style>
            #map { height: 500px; }
        </style>O
{% endblock %}
{% block content %}
{% if object_list %}
<div class="row">
	<div class="col-md-4">
		<div class="panel panel-default panel-fixed" >
			<div class="panel-heading" style="text-align:center;">
				<h3>Places</h3><a href="{% url 'places:place_create' %}">(add another Place)</a>
			</div>
			<div class="panel-body">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Name</th>
							<th>GeoNames</th>
						</th>
					</thead>
					<tbody>
						{% for object in object_list %}
						<tr>
							<td><a href="{% url 'places:place_edit' pk=object.id %}">{{ object }}</a></td>
							<td>{{ object.geonames_id }}</td>
						</tr>
						{% endfor %}
					</tbody>	
				</table>					
			</div>
		</div>
	</div>
	<div class="col-md-8">
		<div class="panel panel-default">
			<div class="panel-heading" style="text-align:center;">
				<h3>Geovisualisation</h3>
			</div>
			<div class="panel-body">
				<div id="parentMap"></div>
			</div>
		</div>
	</div>
</div>


<script type="text/javascript">
	$( document ).ready(function() {
 		$("#map").remove()
    	$("#parentMap").append("<div id='map'></div>");
/*    	var placeName = $("#geonamesSELECT option:selected").text();
    	var gps1 = placeName.split(/\|/)[2];
    	var gps2 = placeName.split(/\|/)[3];*/
    	var map = L.map('map').setView([48.69096, 9.14062], 5);

    	L.tileLayer('http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpg', {
    	attribution: 'Data, imagery and map information provided by MapQuest, OpenStreetMap <http://www.openstreetmap.org/copyright> and contributors, ODbL <http://wiki.openstreetmap.org/wiki/Legal_FAQ#3a._I_would_like_to_use_OpenStreetMap_maps._How_should_I_credit_you.3F>',
    	maxZoom: 18
		}).addTo(map);

    	{% for object in object_list %}
    	{% if object.lat %}
    	L.marker([{{ object.lat }}, {{ object.lng }}])
    	.addTo(map)
    	.bindPopup("<h1>{{ object.name }}</h1> <table class='table table-striped'> <tr> <td>Name: </td> <td>{{ object.name }}</td> </tr> </table>");
    	{% endif %}
    	{% endfor %}
		});
</script>
{% endif %}
{% endblock %}